
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pybedtools.contrib.long_range_interaction.tag_bedpe &#8212; pybedtools 0.8.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pybedtools.contrib.long_range_interaction.cis_trans_interactions" href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" />
    <link rel="prev" title="pybedtools.contrib.venn_maker.cleaned_intersect" href="pybedtools.contrib.venn_maker.cleaned_intersect.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pybedtools-contrib-long-range-interaction-tag-bedpe">
<h1>pybedtools.contrib.long_range_interaction.tag_bedpe<a class="headerlink" href="#pybedtools-contrib-long-range-interaction-tag-bedpe" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pybedtools.contrib.long_range_interaction.tag_bedpe">
<code class="descclassname">pybedtools.contrib.long_range_interaction.</code><code class="descname">tag_bedpe</code><span class="sig-paren">(</span><em>bedpe</em>, <em>queries</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pybedtools/contrib/long_range_interaction.html#tag_bedpe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pybedtools.contrib.long_range_interaction.tag_bedpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Tag each end of a BEDPE with a set of (possibly many) query BED files.</p>
<p>For example, given a BEDPE of interacting fragments from a Hi-C experiment,
identify the contacts between promoters and ChIP-seq peaks. In this case,
promoters and ChIP-seq peaks of interest would be provided as BED files.</p>
<p>The strategy is to split the BEDPE into two separate files.  Each file is
intersected independently with the set of queries.  The results are then
iterated through in parallel to tie the ends back together. It is this
iterator that is returned (see example below).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>bedpe</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">BEDPE-format file. Must be name-sorted.</p>
</dd>
<dt><strong>queries</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first">Dictionary of BED/GFF/GTF/VCF files to use. After splitting the BEDPE,
these query files (values in the dictionary) will be passed as the <code class="file docutils literal notranslate"><span class="pre">-b</span></code>
arg to <code class="file docutils literal notranslate"><span class="pre">bedtools</span> <span class="pre">intersect</span></code>. The keys are passed as the <code class="file docutils literal notranslate"><span class="pre">names</span></code>
argument for <code class="file docutils literal notranslate"><span class="pre">bedtools</span> <span class="pre">intersect</span></code></p>
<p><em>Features in each file must have unique names</em>. Use
<code class="xref py py-func docutils literal notranslate"><span class="pre">pybedtools.featurefuncs.UniqueID()</span></code> to help fix this.</p>
<p class="last"><em>Each file must be BED3 to BED6</em>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Tuple of (iterator, n, extra).</strong></dt>
<dd></dd>
<dt><strong>`iterator` is described below. `n` is the total number of lines in the</strong></dt>
<dd></dd>
<dt><strong>BEDPE file, which is useful for calculating percentage complete for</strong></dt>
<dd></dd>
<dt><strong>downstream work. `extra` is the number of extra fields found in the BEDPE</strong></dt>
<dd></dd>
<dt><strong>(also useful for downstream processing).</strong></dt>
<dd></dd>
<dt><strong>`iterator` yields tuples of (label, end1_hits, end2_hits) where `label` is</strong></dt>
<dd></dd>
<dt><strong>the name field of one line of the original BEDPE file. `end1_hits` and</strong></dt>
<dd></dd>
<dt><strong>`end2_hits` are each iterators of BED-like lines representing all</strong></dt>
<dd></dd>
<dt><strong>identified intersections across all query BED files for end1 and end2 for</strong></dt>
<dd></dd>
<dt><strong>this pair.</strong></dt>
<dd></dd>
<dt><strong>Recall that BEDPE format defines a single name and a single score for each</strong></dt>
<dd></dd>
<dt><strong>pair. For each item in `end1_hits`, the fields are::</strong></dt>
<dd><p class="first last">chrom1
start1
end1
name
score
strand1
[extra fields]
query_label
fields_from_query_intersecting_end1</p>
</dd>
<dt><strong>where `[extra fields]` are any additional fields from the original BEDPE,</strong></dt>
<dd></dd>
<dt><strong>`query_label` is one of the keys in the `beds` input dictionary, and the</strong></dt>
<dd></dd>
<dt><strong>remaining fields in the line are the intersecting line from the</strong></dt>
<dd></dd>
<dt><strong>corresponding BED file in the `beds` input dictionary.</strong></dt>
<dd></dd>
<dt><strong>Similarly, each item in `end2_hits` consists of:</strong></dt>
<dd><p class="first last">chrom2
start2
end2
name
score
strand2
[extra fields]
query_label
fields_from_query_intersecting_end2</p>
</dd>
<dt><strong>At least one line is reported for every line in the BEDPE file. If there</strong></dt>
<dd></dd>
<dt><strong>was no intersection, the standard BEDTools null fields will be shown. In</strong></dt>
<dd></dd>
<dt><strong>`end1_hits` and `end2_hits`, a line will be reported for each hit in each</strong></dt>
<dd></dd>
<dt><strong>query.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pybedtools</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../main.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main.html#running-tests-compiling-docs">Running tests, compiling docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3-brief-examples.html">Three brief examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial-contents.html">Tutorial Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topical-documentation-contents.html">Topical Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../autodoc_source.html"><code class="docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#bedtool-creation"><code class="docutils literal notranslate"><span class="pre">BedTool</span></code> creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#bedtools-wrappers"><code class="file docutils literal notranslate"><span class="pre">BEDTools</span></code> wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#other-bedtool-methods">Other <code class="docutils literal notranslate"><span class="pre">BedTool</span></code> methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#module-level-functions">Module-level functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../autodoc_source.html#pybedtools-contrib"><code class="docutils literal notranslate"><span class="pre">pybedtools.contrib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#scripts">Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../autodoc_source.html"><code class="docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a><ul>
      <li>Previous: <a href="pybedtools.contrib.venn_maker.cleaned_intersect.html" title="previous chapter">pybedtools.contrib.venn_maker.cleaned_intersect</a></li>
      <li>Next: <a href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" title="next chapter">pybedtools.contrib.long_range_interaction.cis_trans_interactions</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" title="pybedtools.contrib.long_range_interaction.cis_trans_interactions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pybedtools.contrib.venn_maker.cleaned_intersect.html" title="pybedtools.contrib.venn_maker.cleaned_intersect"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pybedtools 0.8.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../autodoc_source.html" accesskey="U"><code class="docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a> &#187;</li> 
      </ul>
    </div>


    <div class="footer">
      &copy;2010-2015, Ryan Dale.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/autodocs/pybedtools.contrib.long_range_interaction.tag_bedpe.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>